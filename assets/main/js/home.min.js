import{preloadImages}from"../../libs/utils.js";function projectScroll(){gsap.registerPlugin(ScrollTrigger,SplitText);let o=gsap.utils.toArray(".project"),a=o[0];gsap.utils.toArray(".project-title h2").forEach(e=>{new SplitText(e,{type:"words, chars",charsClass:"char",wordsClass:"word"}).chars.forEach(e=>{e.innerHTML=`<span>${e.textContent}</span>`})});let l=a.querySelector(".project-img"),p=a.querySelector(".project-img img");function i(e,t,r){gsap.to(e,{filter:"blur(0px)",y:0,skewX:"0deg",opacity:1}),gsap.to(t,{y:0,opacity:1,duration:.75,ease:"power4.out"}),gsap.to(r,{y:0,opacity:1,duration:.75,delay:.05,ease:"power4.out"})}function s(e,t,r){gsap.to(e,{filter:"blur(10px)",y:10,willChange:"filter, transform",opacity:0,skewX:"-3deg"}),gsap.to(t,{y:"40px",opacity:0,duration:.5,ease:"power4.out"}),gsap.to(r,{y:"40px",opacity:0,duration:.5,ease:"power4.out"})}gsap.set(l,{scale:.5,borderRadius:"400px"}),gsap.set(p,{scale:1.5});let n=a.querySelectorAll(".char span"),c=a.querySelector(".project-description"),g=a.querySelector(".project-button");var e=100*(o.length-1)+"vh";ScrollTrigger.create({trigger:a,start:"top top",end:"+="+e,onUpdate:e=>{var e=e.progress,t=.5+.5*e,r=400-400*e,o=1.5-.5*e;gsap.set(l,{scale:t,borderRadius:r+"px"}),gsap.set(p,{scale:o}),1<=e&&!a.contentRevealed&&(a.contentRevealed=!0,i(n,c,g)),e<1&&a.contentRevealed&&(a.contentRevealed=!1,s(n,c,g))}}),o.forEach((e,t)=>{t=t===o.length-1;ScrollTrigger.create({trigger:e,start:"top top",end:t?"+=100vh":"top top",endTrigger:t?null:o[o.length-1],pin:!0,pinSpacing:t})}),o.forEach((e,r)=>{if(r<o.length-1){let t=e.querySelector(".project-wrapper");ScrollTrigger.create({trigger:o[r+1],start:"top bottom",end:"top top",onUpdate:e=>{e=e.progress;gsap.set(t,{scale:1-.15*e,opacity:1-e})}})}}),o.forEach((e,t)=>{if(0<t){let t=e.querySelector(".project-img img"),r=e.querySelector(".project-img");ScrollTrigger.create({trigger:e,start:"top bottom",end:"top top",onUpdate:e=>{e=e.progress;gsap.set(t,{scale:2-e}),gsap.set(r,{borderRadius:50-50*e+"px"})}})}}),o.forEach((o,e)=>{if(0!==e){let e=o.querySelector(".project-description"),t=o.querySelectorAll(".char span"),r=o.querySelector(".project-button");ScrollTrigger.create({trigger:o,start:"top top",onEnter:()=>i(t,e,r),onLeaveBack:()=>s(t,e,r)})}}),ScrollTrigger.refresh()}function marquee(){document.querySelectorAll(".marquee-container").forEach(e=>{let t=e.querySelector(".marquee-content");var r=[...e.querySelectorAll(".marquee-item")],o=parseFloat(e.getAttribute("data-speed"))||50;let a=0;r.forEach(e=>a+=e.offsetWidth);var l=e.offsetWidth,p=Math.ceil(l/a)+4;for(let e=0;e<p;e++)r.forEach(e=>{t.appendChild(e.cloneNode(!0))});gsap.set(t,{x:0,willChange:"transform",force3D:!0});let i=gsap.timeline({repeat:-1});i.to(t,{x:-a,duration:a/o,ease:"none",modifiers:{x:e=>parseFloat(e)%a+"px"}}),e.addEventListener("mouseenter",()=>i.pause()),e.addEventListener("mouseleave",()=>i.resume())})}function loadBTV(){if(gsap.to(".banner-word",{autoAlpha:1,duration:1,ease:"power3.out",delay:1}),gsap.set("#btnModalHighlight",{xPercent:50}),gsap.to("#btnModalHighlight",{xPercent:0,autoAlpha:1,delay:1}),window.innerWidth<991){let t=document.querySelector("#btnModalHighlight");gsap.set(t,{x:0,autoAlpha:1}),ScrollTrigger.create({trigger:"body",start:"top top",end:"bottom bottom",onUpdate:e=>{1===e.direction?gsap.to(t,{x:10,autoAlpha:0,duration:.3,ease:"power2.out"}):gsap.to(t,{x:0,autoAlpha:1,duration:.3,ease:"power2.out"})}})}}let init=()=>{gsap.registerPlugin(ScrollTrigger),projectScroll(),marquee(),loadBTV()};preloadImages("img").then(()=>{init()}),$(window).on("beforeunload",function(){$(window).scrollTop(0)});