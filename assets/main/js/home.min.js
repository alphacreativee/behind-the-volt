import{preloadImages}from"../../libs/utils.js";function projectScroll(){gsap.registerPlugin(ScrollTrigger,SplitText);let o=gsap.utils.toArray(".project"),a=o[0];gsap.utils.toArray(".project-title h2").forEach(e=>{new SplitText(e,{type:"words, chars",charsClass:"char",wordsClass:"word"}).chars.forEach(e=>{e.innerHTML=`<span>${e.textContent}</span>`})});let l=a.querySelector(".project-img"),p=a.querySelector(".project-img img");function c(e,t,r){gsap.to(e,{filter:"blur(0px)",y:0,skewX:"0deg",opacity:1}),gsap.to(t,{y:0,opacity:1,duration:.75,ease:"power4.out"}),gsap.to(r,{y:0,opacity:1,duration:.75,delay:.05,ease:"power4.out"})}function s(e,t,r){gsap.to(e,{filter:"blur(10px)",y:10,willChange:"filter, transform",opacity:0,skewX:"-3deg"}),gsap.to(t,{y:"40px",opacity:0,duration:.5,ease:"power4.out"}),gsap.to(r,{y:"40px",opacity:0,duration:.5,ease:"power4.out"})}gsap.set(l,{scale:.5,borderRadius:"400px"}),gsap.set(p,{scale:1.5});let i=a.querySelectorAll(".char span"),n=a.querySelector(".project-description"),g=a.querySelector(".project-button");var e=100*(o.length-1)+"vh";ScrollTrigger.create({trigger:a,start:"top top",end:"+="+e,onUpdate:e=>{var e=e.progress,t=.5+.5*e,r=400-400*e,o=1.5-.5*e;gsap.set(l,{scale:t,borderRadius:r+"px"}),gsap.set(p,{scale:o}),1<=e&&!a.contentRevealed&&(a.contentRevealed=!0,c(i,n,g)),e<1&&a.contentRevealed&&(a.contentRevealed=!1,s(i,n,g))}}),o.forEach((e,t)=>{t=t===o.length-1;ScrollTrigger.create({trigger:e,start:"top top",end:t?"+=100vh":"top top",endTrigger:t?null:o[o.length-1],pin:!0,pinSpacing:t})}),o.forEach((e,r)=>{if(r<o.length-1){let t=e.querySelector(".project-wrapper");ScrollTrigger.create({trigger:o[r+1],start:"top bottom",end:"top top",onUpdate:e=>{e=e.progress;gsap.set(t,{scale:1-.15*e,opacity:1-e})}})}}),o.forEach((e,t)=>{if(0<t){let t=e.querySelector(".project-img img"),r=e.querySelector(".project-img");ScrollTrigger.create({trigger:e,start:"top bottom",end:"top top",onUpdate:e=>{e=e.progress;gsap.set(t,{scale:2-e}),gsap.set(r,{borderRadius:50-50*e+"px"})}})}}),o.forEach((o,e)=>{if(0!==e){let e=o.querySelector(".project-description"),t=o.querySelectorAll(".char span"),r=o.querySelector(".project-button");ScrollTrigger.create({trigger:o,start:"top top",onEnter:()=>c(t,e,r),onLeaveBack:()=>s(t,e,r)})}}),ScrollTrigger.refresh()}function marquee(){document.querySelectorAll(".marquee-container").forEach(e=>{let t=e.querySelector(".marquee-content");var r=[...e.querySelectorAll(".marquee-item")],o=parseFloat(e.getAttribute("data-speed"))||50,a=(t.innerHTML="",r.forEach(e=>t.appendChild(e.cloneNode(!0))),[...t.children]);let l=0;a.forEach(e=>l+=e.offsetWidth);var r=e.offsetWidth,p=Math.ceil(r/l)+2;for(let e=0;e<p;e++)a.forEach(e=>{t.appendChild(e.cloneNode(!0))});let c=0,s=([...t.children].forEach(e=>c+=e.offsetWidth),gsap.set(t,{x:0,willChange:"transform",force3D:!0}),gsap.timeline({repeat:-1}));s.to(t,{x:-c,duration:c/o,ease:"none",modifiers:{x:e=>parseFloat(e)%c+"px"}}),e.addEventListener("mouseenter",()=>s.pause()),e.addEventListener("mouseleave",()=>s.resume())})}let init=()=>{gsap.registerPlugin(ScrollTrigger),projectScroll(),marquee()};preloadImages("img").then(()=>{init()}),$(window).on("beforeunload",function(){$(window).scrollTop(0)});